# Skeleton Estimation

This part was executed first locally, by following

https://github.com/akanazawa/hmr

(Tensorflow 1.3.0 and python 2.7)

&

https://github.com/russoale/hmr2.0

(Tensorflow 2 and python 3.8)

My work is based on this last repo, because the first one has an old setup (obsolete).


First results:

<img src="estimation_tf2.png" width="650" height="450">


Then I saved the generator model of the network into .pb file to switch into Tensorflow Serving: given the checkpoints, in demo.py I added a single line to save the model in .pb format: tf.saved_model.save(model.generator, “new_saving_folder”).


Now we are able to retrieve this model both in local and via tf-serving to make inference:


-in local -> upload img, model and input/output tensor_name; preprocess img in the same way of original code; make inference with “model.signatures” and compare this result with the previous.



-tf-serving -> Installing in the same way as person detection tf serving:
then run in a shell:

sudo docker run --gpus all -p 8500:8500 -p 8501:8501 --name tfserving \            -e TF_FORCE_GPU_ALLOW_GROWTH=true \            -v "$(pwd)/models/:/models/" -t tensorflow/serving:latest-gpu \            --model_config_file=/models/models.config \            --model_config_file_poll_wait_seconds=450


In another shell digit: python main.py to see again the above results.


Skeleton estimation will give as output the set of 3d joints (3x19) for each inferenced frame. This will be taken from 1) my custom AR training papeline & 2) the AR (LSTM) trained engine to detect which activity is.

### State of art

Recurrent neural networks (RNNs) have been widely adopted in the 3D skeleton-based AR problem. RNNs could effectively extract temporal information and learn contextual information well. However, RNNs tend to over-emphasize temporal information, especially when training data is insufficient, thus leading to over-adaptation.
Convolutional neural networks (CNNs) have also been applied to this problem. Unlike RNNs, how to effectively represent 3D skeletal data and insert it into deep CNNs is still an open question. For example, we could think of representing each skeleton sequence as an image, where the temporal dynamics of the sequence are encoded as changes in the columns and the spatial structure of each frame is represented as a column.





